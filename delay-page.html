<!DOCTYPE html>

<html>
<title>Experimenting with Delay Effects</title>
<body>
	<h1>Experimenting with Delay Effects</h1>

	<br>

	<h3>Experiment with applying a delay effect to the embedded audio.  Use the sliders below to play around with the time of the delay, the amount of feedback, and the phase inversion.</h3>

	<br>
	<br>

	<div class='controls'>
		<button class="play" disabled>loading...</button>
		<button class="stop" disabled>stop</button>
	</div>

	<br>

<div class='delay-controls'>
    <label for='delayTime'>Delay Time: <span class='time'>5 s</span>

        <input class='delayTime-slider' name='delayTime' type='range' min='0' max='5' step='0.1' value='3.0' disabled/>
    </label>

    <!--<p>Filter Type: </p>
    <select name="filterType" class="filtertype">
        <option value="lowpass">Lowpass</option>
    </select> -->
</div>

<br>
<br>

<h3><a href="index.html">Back to Home</a></h3>

</body>
<script>

window.AudioContext = window.AudioContext || window.webkitAudioContext;
window.context = new AudioContext();

var RobynBuffer;
var getRobynBuffer = new XMLHttpRequest();
getRobynBuffer.open("GET", "https://raw.githubusercontent.com/mf3180/mf3180.github.io/master/Dancing%20On%20My%20Own.mp3", true);
getRobynBuffer.responseType = "arraybuffer";

getRobynBuffer.onload = function() {
	context.decodeAudioData(getRobynBuffer.response, function(buffer){
		RobynBuffer = buffer;
	});
}

getRobynBuffer.send();

function playRobyn() {
	var _playRobyn = context.createBufferSource();
	_playRobyn.buffer = RobynBuffer;
	_playRobyn.connect(delayOne);
	_playRobyn.connect(context.destination);
	_playRobyn.start(context.currentTime);
}

function myDelay(_delayTime, feedback) {
	var delay = context.createDelay();
	delay.delayTime.value = _delayTime;

	var _feedback = context.createGain();
	_feedback.gain.value = feedback;

	var filter = context.createBiquadFilter();
	filter.frequency.value = 2000;

	filter.connect(delay);

	delay.connect(_feedback);

	_feedback.connect(filter);

	delay.connect(context.destination);
}

var RobynDelay = myDelay(0.3, 0.2);
RobynDelay.connect(context.destination);
</script>
</html>